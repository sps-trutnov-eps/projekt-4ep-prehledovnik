<!doctype html>
<%- include('partials/head'); %>

    <style>
        #doc {
            max-width: 90ch;
            margin-inline: auto;

            h1, h2, h3, h4, h5 {
                text-align: center;
            }
        }

        #cat {
            display: block;
            margin-inline: auto;
            margin-top: 2em;
        }

    </style>
<article style="flex: 3;">
    <main>
        <div id="doc">
            <%- doc %>
        </div>
        <img id="cat" style="display: none; object-fit: contain; max-height: 100%;" 
             src="https://cataas.com/cat/says/P%C5%99ehledovn%C3%ADk?fontColor=orange&fontSize=64" 
             alt="P≈ôehledovn√≠k">
    </main>
</article>

<script>
    (function () {
        let command = "";
        const secret = "mnau";
        const docElement = document.getElementById("doc");
        let catImage = null; 

        document.addEventListener("keydown", (event) => {
            const key = event.key.toLowerCase();

            if (key === "r" && catImage) {
                changeCatImage();
                return;
            }

            command += key;
            if (!secret.startsWith(command)) {
                command = ""; 
            }
            if (command === secret) {
                console.log("üê± M≈àau! P≈ôehledovn√≠k je teƒè jen o koƒçk√°ch!");

                localStorage.setItem("originalDoc", docElement.innerHTML);

                docElement.innerHTML = `
                    <div style="display: flex; justify-content: center; align-items: center; flex-direction: column;">
                        <img id="randomCat" src="https://cataas.com/cat?timestamp=${new Date().getTime()}" 
                             style="max-width: 100%; max-height: 100%;" alt="M≈àau!">
                        <p style="color: black; font-size: 18px;">Stiskni <strong>R</strong> pro jin√Ω obr√°zek!</p>
                    </div>
                `;

                catImage = document.getElementById("randomCat");

                command = ""; 
            }
        });

        function changeCatImage() {
            if (catImage) {
                catImage.src = `https://cataas.com/cat?timestamp=${new Date().getTime()}`;
                console.log("üîÑ Nov√° koƒçka naƒçtena!");
            }
        }

        window.addEventListener("load", () => {
            const originalContent = localStorage.getItem("originalDoc");
            if (originalContent) {
                docElement.innerHTML = originalContent;
                localStorage.removeItem("originalDoc"); 
            }
        });
    })();
</script>

<%- include('partials/tail') %>